<!DOCTYPE html>
<html lang="zh-CN">

{{ template "head.tpl.html" . }}
<script src="assets/js/timezones.js"></script>
<script>
    // Constants
    const defaultTab = 'account'
    const userTimeZone = {{ .User.Location }}
    const userTzOffset = {{ localTZOffset.Hours }}
    const signPrefix = userTzOffset >= 0 ? '+' : ''
    const defaultTzOption = { value: 'Local', text: `Local server time (UTC${signPrefix}${userTzOffset})` }
</script>
<script type="module" src="assets/js/components/settings.js"></script>

<body class="bg-background text-muted p-4 pt-10 flex flex-col min-h-screen max-w-screen-xl mx-auto justify-center">
<style>
    .inline-bullet-list li a {
        text-decoration: underline;
    }

    .inline-bullet-list li:after {
        content: "•";
    }

    .inline-bullet-list li:last-child:after {
        content: "";
    }
</style>

{{ template "menu-main.tpl.html" . }}

{{ template "alerts.tpl.html" . }}

<main class="mt-10 grow flex justify-center w-full" v-scope @vue:mounted="mounted" id="settings-page">
    <div class="flex flex-col grow mt-10 max-w-full">
        <h1 class="font-semibold text-3xl text-primary m-0 mb-4">设置</h1>

        <ul class="flex gap-x-4 mb-16 text-muted flex-wrap sm:flex-nowrap">
            <li class="font-semibold text-2xl" v-bind:class="{ 'text-foreground': isActive('account'), 'hover:text-secondary': !isActive('account') }">
                <a href="settings#account" @click="updateTab">账户</a>
            </li>
            <li class="font-semibold text-2xl" v-bind:class="{ 'text-foreground': isActive('data'), 'hover:text-secondary': !isActive('data') }">
                <a href="settings#data" @click="updateTab">数据</a>
            </li>
            <li class="font-semibold text-2xl" v-bind:class="{ 'text-foreground': isActive('permissions'), 'hover:text-secondary': !isActive('permissions') }">
                <a href="settings#permissions" @click="updateTab">权限</a>
            </li>
            <li class="font-semibold text-2xl" v-bind:class="{ 'text-foreground': isActive('integrations'), 'hover:text-secondary': !isActive('integrations') }">
                <a href="settings#integrations" @click="updateTab">集成</a>
            </li>
            {{ if .SubscriptionsEnabled }}
            <li class="font-semibold text-2xl" v-bind:class="{ 'text-foreground': isActive('subscription'), 'hover:text-secondary': !isActive('subscription') }">
                <a href="settings#subscription" @click="updateTab">订阅</a>
            </li>
            {{ end }}
            <li class="font-semibold text-2xl" v-bind:class="{ 'text-foreground': isActive('api_keys'), 'hover:text-secondary': !isActive('api_keys') }">
                <a href="settings#api_keys" @click="updateTab">API 密钥</a>
            </li>
            <li class="font-semibold text-2xl" v-bind:class="{ 'text-foreground': isActive('danger_zone'), 'hover:text-secondary': !isActive('danger_zone') }">
                <a href="settings#danger_zone" @click="updateTab">危险区域</a>
            </li>
        </ul>

        <div v-cloak id="account" class="tab flex flex-col space-y-4" v-if="isActive('account')">
            <!-- Account Settings -->
            <form action="" method="post" class="w-full md:w-3/4">
                <input type="hidden" name="action" value="update_user">

                <div class="flex mb-8">
                    <div class="w-1/2 mr-4 inline-block">
<label class="font-semibold text-foreground" for="select-timezone">时区</label>
                        <span class="block text-sm text-muted">您所在的时区。用于显示每日统计数据。</span>
                    </div>
                    <div class="w-1/2 ml-4">
                        <select name="location" id="select-timezone" class="select-default" v-model="selectedTimezone">
                            <option v-for="o in tzOptions" :value="o.value">{{ "{{" }}o.text{{ "}}" }}</option>
                        </select>
                    </div>
                </div>

                <div class="flex mb-8">
                    <div class="w-1/2 mr-4 inline-block">
<label class="font-semibold text-foreground" for="select-start-of-week">每周起始日</label>
                        <span class="block text-sm text-muted">选择您每周从哪一天开始。这会影响"本周"和"上周"的时间范围。</span>
                    </div>
                    <div class="w-1/2 ml-4">
                        <select name="start_of_week" id="select-start-of-week" class="select-default">
<option value="0" {{ if eq .User.StartOfWeek 0 }}selected{{ end }}>周日</option>
                            <option value="1" {{ if eq .User.StartOfWeek 1 }}selected{{ end }}>周一</option>
                            <option value="2" {{ if eq .User.StartOfWeek 2 }}selected{{ end }}>周二</option>
                            <option value="3" {{ if eq .User.StartOfWeek 3 }}selected{{ end }}>周三</option>
                            <option value="4" {{ if eq .User.StartOfWeek 4 }}selected{{ end }}>周四</option>
                            <option value="5" {{ if eq .User.StartOfWeek 5 }}selected{{ end }}>周五</option>
                            <option value="6" {{ if eq .User.StartOfWeek 6 }}selected{{ end }}>周六</option>
                        </select>
                    </div>
                </div>
                <div class="flex mb-8">
                    <div class="w-1/2 mr-4 inline-block">
<label class="font-semibold text-foreground" for="email">邮箱地址</label>
                        <span class="block text-sm text-muted">
                            可选填，但每周报告和密码重置功能需要使用。
                        </span>
                    </div>
                    <div class="w-1/2 ml-4">
                        <input class="input-default {{ if .User.HasActiveSubscription }}cursor-not-allowed{{ end }}"
                               type="email" id="email"
                               name="email" placeholder="请输入您的邮箱地址"
                               value="{{ .User.Email }}"
                        >
                    </div>
                </div>

                {{ if .User.Email }}
                <div class="flex mb-8">
                    <div class="w-1/2 mr-4 inline-block">
<label class="font-semibold text-foreground" for="reports_weekly">每周邮件报告</label>
                        <span class="block text-sm text-muted">选择每周接收一次编码活动摘要。</span>
                    </div>
                    <div class="w-1/2 ml-4">
                        <select autocomplete="off" id="reports_weekly" name="reports_weekly"
                                class="select-default">
<option value="false" class="cursor-pointer" {{ if not .User.ReportsWeekly }} selected{{ end }}>禁用</option>
                            <option value="true" class="cursor-pointer" {{ if .User.ReportsWeekly }} selected {{ end }}>启用</option>
                        </select>
                    </div>
                </div>
                {{ end }}

                <div class="flex justify-end mt-4">
<button type="submit" class="btn-primary">
                        保存
                    </button>
                </div>
            </form>

            <!-- Password -->
            {{ if eq .User.AuthType "local" }}
            <div class="w-full md:w-3/4">
                <hr class="border-t border-focused my-4">
            </div>

            <form class="w-full md:w-3/4" action="" method="post">
                <input type="hidden" name="action" value="change_password">

                <div class="flex mb-8">
                    <div class="w-1/2 mr-4 inline-block">
<label class="font-semibold text-foreground" for="password_old">当前密码</label>
                        <span class="block text-sm text-muted">输入您的旧密码进行验证。</span>
                    </div>
                    <div class="w-1/2 ml-4">
                        <input class="input-default"
                               type="password" id="password_old"
                               name="password_old" placeholder="旧密码" minlength="6" required>
                    </div>
                </div>

                <div class="flex mb-8">
                    <div class="w-1/2 mr-4 inline-block">
<label class="font-semibold text-foreground" for="password_new">新密码</label>
                        <span class="block text-sm text-muted">请选择一个新密码。建议至少 8 个字符，包含字母、数字和特殊字符。</span>
                    </div>
                    <div class="w-1/2 ml-4">
                        <input class="input-default"
                               type="password" id="password_new"
                               name="password_new" placeholder="新密码" minlength="6" required>
                    </div>
                </div>

                <div class="flex mb-8">
                    <div class="w-1/2 mr-4 inline-block">
<label class="font-semibold text-foreground" for="password_repeat">重复密码</label>
                        <span class="block text-sm text-muted">再输入一次...</span>
                    </div>
                    <div class="w-1/2 ml-4">
                        <input class="input-default"
                               type="password" id="password_repeat"
                               name="password_repeat" placeholder="重复输入密码" minlength="6" required>
                    </div>
                </div>

                <div class="flex justify-end mt-4">
<button type="submit" class="btn-primary">
                        保存
                    </button>
                </div>
            </form>
            {{ end }}

            {{ if .InvitesEnabled }}
            <div class="w-full md:w-3/4">
                <hr class="border-t border-focused my-4">
            </div>

            <!-- User Invite -->
            <form class="w-full md:w-3/4" action="" method="post">
                <input type="hidden" name="action" value="generate_invite">

                <div class="flex mb-8">
                    <div class="w-2/3 mr-4 inline-block">
<span class="font-semibold text-foreground">邀请好友</span>
                        <span class="block text-sm text-muted">
                            您可以使用专属邀请码邀请新用户加入 Wakapi。点击生成邀请码，然后将链接发送给您的朋友。感谢您帮助推广 Wakapi！
                        </span>

                        {{ if ne .InviteLink "" }}
                        <div class="mt-4">
                            <label class="text-sm text-foreground mb-2" for="invite_code_result">成功！这是您的邀请链接：</label>
                            <input type="url" name="invite_code" id="invite_code_result"
                                   class="w-full appearance-none bg-card text-foreground outline-none rounded py-2 px-4 mb-2 cursor-not-allowed font-mono text-sm"
                                   readonly value="{{ .InviteLink }}">
                        </div>
                        {{ end }}
                    </div>
                    {{ if eq .InviteLink "" }}
                    <div class="w-1/3 ml-4 flex items-center justify-end">
                        <button type="submit" class="btn-primary ml-1">生成</button>
                    </div>
                    {{ end }}
                </div>
            </form>
            {{ end }}

        </div>

        <div v-cloak id="data" class="tab flex flex-col space-y-4" v-if="isActive('data')">

            <!-- Unknown Projects -->
            <form class="w-full" action="" method="post">
                <input type="hidden" name="action" value="update_unknown_projects">
                <div class="flex flex-wrap md:flex-nowrap mb-2 gap-x-4">
                    <div class="w-full md:w-1/3 mb-2 md:mb-0 inline-block">
<span class="font-semibold text-foreground text-lg">未知项目</span>
                        <p class="block text-sm text-muted">
                            您可以选择排除和忽略来自未知项目的编码统计。更改此设置将需要重新计算您的统计数据。
                        </p>
                    </div>

                    <div class="flex-col w-full md:w-2/3 inline-block space-y-4">
                        <div class="flex justify-between items-center">
                            <div class="flex flex-col gap-y-1">
<label class="font-semibold text-foreground" for="unknown-projects-toggle">排除未知项目</label>
                                <select autocomplete="off" id="unknown-projects-toggle" name="exclude_unknown_projects" class="select-default wi-min">
                                    <option value="false" class="cursor-pointer" {{ if not .User.ExcludeUnknownProjects }} selected {{ end }}>否
                                    </option>
                                    <option value="true" class="cursor-pointer" {{ if .User.ExcludeUnknownProjects }} selected {{ end }}>是
                                    </option>
                                </select>
                            </div>
                            <button type="submit" class="btn-primary h-min">保存</button>
                        </div>
                    </div>
                </div>
            </form>

            <div class="w-full">
                <hr class="border-t border-focused my-4">
            </div>

            <!-- Aliases -->
            <div class="w-full">
                <div class="flex flex-wrap flex-nowrap mb-8 gap-x-4">
                    <div class="w-full md:w-1/3 mb-4 md:mb-0 inline-block">
<span class="font-semibold text-foreground text-lg">别名</span>
                        <p class="block text-sm text-muted">您可以为任何类型的实体指定别名。例如，您可以定义一个规则，将 "myapp-frontend" 和 "myapp-backend" 合并到名为 "myapp" 的项目下。</p>
                    </div>

                    <div class="w-full md:w-2/3 inline-block">
                        {{ if .Aliases }}
                        <div class="mb-8">
                            <h3 class="inline-block font-semibold text-foreground">规则</h3>
                            {{ range $i, $alias := .Aliases }}
                            <div class="flex items-center">
                                <div class="text-foreground border-1 w-full inline-block my-1 py-1 text-align text-sm"
                                     style="line-height: 1.8">
                                    &#9656;&nbsp; 所有名为 <span class="font-semibold">{{ $alias.Type | typeName }}</span>
                                    {{ range $j, $value := $alias.Values }}
                                    <span class="chip text-accent">{{- $value -}}</span>
                                    {{ if lt $j (add (len $alias.Values) -2) }}
                                    <span class="-ml-1">{{- ", " | capitalize -}}</span>
                                    {{ else if lt $j (add (len $alias.Values) -1) }}
                                    <span>{{- "或" -}}</span>
                                    {{ end }}
                                    {{ end }}
                                    映射到 <span class="font-semibold">{{ $alias.Type | typeName }}</span> <span
                                        class="chip text-accent">{{ $alias.Key }}</span>
                                </div>
                                <form class="float-right" action="" method="post">
                                    <input type="hidden" name="action" value="delete_alias">
                                    <input type="hidden" id="delete_alias_key" name="key" required value="{{ $alias.Key }}">
                                    <input type="hidden" id="delete_alias_type" name="type" required value="{{ $alias.Type }}">
                                    <button type="submit" class="py-2 px-4 rounded bg-card hover:bg-focused text-red-600 text-sm" title="删除规则">✕</button>
                                </form>
                            </div>
                            {{end}}
                        </div>
                        {{end}}

                        <form action="" method="post" class="mb-2">
                            <h3 class="inline-block font-semibold text-foreground">添加规则</h3>

                            <input type="hidden" name="action" value="add_alias">
                            <div class="flex items-center mt-2 w-full text-secondary text-sm">
                                <span class="mr-2">将</span>
                                <select name="type" id="select-type" class="select-default" style="max-width: 256px">
                                    {{ range $i, $t := entityTypes }}
                                    <option value="{{ $t }}">{{ $t | typeName | capitalize }}</option>
                                    {{ end }}
                                </select>
                                <span class="mx-2">名为</span>
                                <input class="input-default"
                                       type="text" id="alias-value" style="width: 130px;"
                                       name="value" placeholder="原名称" minlength="1" required>
                                <span class="mx-2">映射到</span>
                                <input class="input-default"
                                       type="text" id="alias-key" style="width: 100px"
                                       name="key" placeholder="替换名称" minlength="1" required>
                                <div class="flex justify-end ml-4">
<button type="submit" class="btn-primary">
                                        添加
                                    </button>
                                </div>
                            </div>
                        </form>

                        <p class="text-sm text-muted">支持通配符模式，详见 <a href="https://github.com/becheran/wildmatch-go" target="_blank" rel="noopener noreferrer" class="link">此处</a>。</p>
                    </div>
                </div>
            </div>

            <div class="w-full">
                <hr class="border-t border-focused my-4">
            </div>

            <!-- Project Labels -->
            <div class="w-full">
                <div class="flex flex-wrap md:flex-nowrap mb-8 gap-x-4">
                    <div class="w-full md:w-1/3 mb-4 md:mb-0 inline-block">
<span class="font-semibold text-foreground text-lg">项目标签</span>
                        <p class="block text-sm text-muted">您可以为项目分配标签（又称标记）来对它们进行分组，例如按 "私人" 和 "工作" 分类。</p>
                    </div>

                    <div class="w-full md:w-2/3 inline-block">
                        {{ if .Labels }}
                        <div class="mb-8">
                            <h3 class="inline-block font-semibold text-foreground">您的标签</h3>
                            {{ range $i, $label := .Labels }}
                            <div class="flex items-center">
                                <div class="text-secondary border-1 w-full border-accent inline-block my-1 py-1 text-align text-sm"
                                     style="line-height: 1.8">
                                    &#9656;&nbsp;&nbsp;<span class="font-semibold text-foreground">{{ $label.Key }}:</span>
                                    {{ range $j, $value := $label.Values }}
                                    <form action="" method="post" class="chip inline-flex justify-between items-center gap-x-2 text-accent">
                                        <input type="hidden" name="action" value="delete_label">
                                        <input type="hidden" name="key" value="{{ $label.Key }}">
                                        <input type="hidden" name="value" value="{{ $value }}">
                                        <span>{{- $value -}}</span>
                                        <button type="submit" class="bg-background text-center hover:bg-muted rounded-full w-4 h-4 leading-none text-danger" title="删除标签">x</button>
                                    </form>
                                    {{ end }}
                                    <div class="ml-3 inline">
                                        <button @click="showProjectAddButton({{ $i }})" class="top-1 relative" v-show="!labels[{{ $i }}]">
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 text-secondary">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15"/>
                                            </svg>
                                        </button>
                                        <form action="" method="post" class="inline-flex gap-x-1" v-show="labels[{{ $i }}]">
                                            <input type="hidden" name="action" class="block" value="add_label">
                                            <input type="hidden" name="value" value="{{ $label.Key }}">
                                            <select name="key" class="block text-sm select-default !w-auto">
                                                {{ range $k, $project := $.Projects }}
                                                <option value="{{ $project }}">{{ $project }}</option>
                                                {{ end }}
                                            </select>
                                            <button type="submit" class="btn-primary btn-small">
                                                &nbsp;+&nbsp;
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            {{end}}
                            <div class="mb-8"></div>
                        </div>
                        {{end}}

                        {{ if .Projects }}
<h3 class="inline-block font-semibold text-foreground">批量关联</h3>
                        <p class="text-sm text-muted">将标签与多个项目关联</p>
                        <form action="" method="post">
                            <input type="hidden" name="action" value="add_label">
                            <input type="hidden" name="num_projects" value="multiple">
                            <div class="mt-2 w-1/2 space-y-4 text-secondary text-sm flex-col flex">
                                <input class="input-default block" name="value" placeholder="标签" required>
                                <select name="key" class="block w-full p-2.5 select-default grow" multiple required>
                                    {{ range $i, $p := .Projects }}
                                    <option value="{{ $p }}" class="bg-transparent checked:text-green-500">{{ $p }}</option>
                                    {{ end }}
                                </select>
<button type="submit" class="btn-primary">
                                    提交
                                </button>
                            </div>
                        </form>
                        {{ else }}
                        <div class="text-foreground text-sm mb-4 mt-6">您还没有任何项目。开始发送一些心跳后才能分配标签。</div>
                        {{ end }}
                    </div>
                </div>
            </div>

            <div class="w-full">
                <hr class="border-t border-focused my-4">
            </div>

            <!-- Language Mappings -->
            <div class="w-full">
                <div class="flex flex-wrap md:flex-nowrap mb-8 gap-x-4">
                    <div class="w-full md:w-1/3 mb-4 md:mb-0 inline-block">
<span class="font-semibold text-foreground text-lg">语言映射</span>
                        <p class="block text-sm text-muted">您可以指定从文件扩展名到编程语言的自定义映射，例如将 ".jsx" 文件映射到 "React" 语言。</p>
                    </div>

                    <div class="w-full md:w-2/3 inline-block">
                        {{ if .LanguageMappings }}
                        <div class="mb-8">
                            <h3 class="inline-block font-semibold text-foreground">规则</h3>
                            {{ range $i, $mapping := .LanguageMappings }}
                            <div class="flex items-center mb-2">
                                <div class="text-foreground border-1 w-full inline-block my-1 py-1 text-align text-sm">
&#9656;&nbsp; 当文件名以 <span
                                        class="text-accent chip mr-1">{{ $mapping.Extension }}</span> 结尾时
                                    将 <span class="font-semibold">语言</span> 更改为 <span
                                        class="text-accent chip mr-1">{{ $mapping.Language }}</span>
                                </div>
                                <form class="float-right" action="" method="post">
                                    <input type="hidden" name="action" value="delete_mapping">
                                    <input type="hidden" id="mapping_id" name="mapping_id" required value="{{ $mapping.ID }}">
                                    <button type="submit" class="py-2 px-4 rounded bg-card hover:bg-focused text-danger text-sm" title="Delete rule">✕</button>
                                </form>
                            </div>
                            {{end}}
                        </div>
                        {{end}}

                        <form action="" method="post">
                            <h3 class="inline-block font-semibold text-foreground">添加规则</h3>

                            <input type="hidden" name="action" value="add_mapping">
                            <div class="flex items-center w-full text-secondary text-sm">
                                <span class="mr-2">当文件名以</span>
                                <input class="input-default grow"
                                       type="text" id="extension" style="width: 70px"
                                       name="extension" placeholder=".py" minlength="1" required>
                                <span class="mx-2">结尾时将语言更改为</span>
                                <input class="input-default grow"
                                       type="text" id="language" style="width: 100px"
                                       name="language" placeholder="Python" minlength="1" required>
                                <div class="flex justify-end ml-4">
<button type="submit" class="btn-primary">
                                        添加
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <div class="w-full">
                <hr class="border-t border-focused my-4">
            </div>

            <!-- Heartbeats Timeout -->
            <form class="w-full" action="" method="post">
                <input type="hidden" name="action" value="update_heartbeats_timeout">
                <div class="flex flex-wrap md:flex-nowrap mb-2 gap-x-4">
                    <div class="w-full md:w-1/3 mb-2 md:mb-0 inline-block">
<span class="font-semibold text-foreground text-lg">心跳超时</span>
                        <p class="block text-sm text-muted">
                            此参数会影响基于启发式算法的计算方式，该算法将 IDE 发送的一系列连续心跳聚合为总编码时间。请参阅我们的 <a class="link" href="https://github.com/muety/wakapi?tab=readme-ov-file#-faqs" rel="noreferrer noopener" target="_blank">常见问题</a> 中的 <i>"如何计算编码时长？"</i> 部分以及 <a class="link" href="https://github.com/muety/wakapi/issues/156" rel="noreferrer noopener" target="_blank">#156</a> 中的讨论。
                        </p>
                    </div>

                    <div class="flex-col w-full md:w-2/3 inline-block space-y-4">
                        <div class="flex justify-between items-center">
                            <div class="flex flex-col flex-grow gap-y-1">
                                <label class="font-semibold text-foreground" for="heartbeats_timeout">超时 / 偏移量（分钟）</label>
                                <div class="flex gap-x-2 items-center">
                                    <input class="input-default" type="number" id="heartbeats_timeout" name="heartbeats_timeout" style="max-width: 100px;" placeholder="1" min="1" max="60" step="1" required value="{{ .User.HeartbeatsTimeoutMin }}">
                                    <span class="text-muted text-sm">（最小 1 分钟，最大 60 分钟）</span>
                                </div>
                            </div>
                            <button type="submit" class="btn-primary h-min">保存</button>
                        </div>
                    </div>
                </div>
            </form>

            <div class="w-full">
                <hr class="border-t border-focused my-4">
            </div>

            <!-- Colors -->
            <div class="w-full">
                <div class="flex flex-wrap md:flex-nowrap mb-8 gap-x-4">
                    <div class="w-full md:w-1/3 mb-4 md:mb-0 inline-block">
<span class="font-semibold text-foreground text-lg">鲜艳颜色</span>
                        <p class="block text-sm text-muted">您可以使用类似于 "语言" 图表的鲜艳颜色来查看整个统计摘要。请注意，此设置仅保存在您的浏览器中。</p>
                    </div>

                    <div class="w-full md:w-2/3 inline-block">
                        <div class="flex-col items-center w-full text-secondary text-sm">
                            <select autocomplete="off" id="vibrant-color-toggle" class="select-default" style="max-width: 6rem" v-model="vibrantColorsEnabled" @change="onToggleVibrantColors">
<option value="false" class="cursor-pointer">禁用</option>
                                <option value="true" class="cursor-pointer">启用</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div v-cloak id="permissions" class="tab flex flex-col space-y-4" v-if="isActive('permissions')">
            <!-- Public Leaderboard -->
            <form action="" method="post" class="w-full lg:w-3/4">
                <div class="flex flex-wrap md:flex-nowrap mb-8 gap-x-4">
                    <div class="w-full md:w-1/2 mb-4 md:mb-0 inline-block">
<span class="font-semibold text-foreground text-lg">公开排行榜</span>
                        <p class="block text-sm text-muted">
                            选择加入以在<a class="link" href="leaderboard">公开排行榜</a>上显示。它显示您过去 7 天编码的汇总统计数据。
                        </p>
                    </div>

                    <div class="flex-col w-full md:w-1/2 inline-block space-y-4">
                        <input type="hidden" name="action" value="update_leaderboard">

                        <div class="flex gap-x-8">
                            <div class="grow">
                                <label class="font-semibold text-foreground" for="enable_leaderboard">参与排行榜</label>
                            </div>
                            <div>
                                <select autocomplete="off" id="enable_leaderboard" name="enable_leaderboard" class="select-default grow">
<option value="false" class="cursor-pointer" {{ if not .User.PublicLeaderboard }} selected {{ end }}>否
                                    </option>
                                    <option value="true" class="cursor-pointer" {{ if .User.PublicLeaderboard }} selected {{ end }}>是
                                    </option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end mt-4">
<button type="submit" class="btn-primary">
                        保存
                    </button>
                </div>
            </form>

            <div class="w-full md:w-3/4">
                <hr class="border-t border-focused my-4">
            </div>

            <!-- Public Data -->
            <form action="" method="post" class="w-full lg:w-3/4">
                <div class="flex flex-wrap md:flex-nowrap mb-8 gap-x-4">
                    <div class="w-full md:w-1/2 mb-4 md:mb-0 inline-block">
<span class="font-semibold text-foreground text-lg">公开数据</span>
                        <p class="block text-sm text-muted">
                            某些功能需要公开访问您的数据而无需身份验证。这主要包括徽章（"shields" 端点）和与 GitHub Readme Stats 的集成（"stats" 端点）。您可以选择通过这些端点公开分享哪些数据。
                        </p>
                    </div>

                    <div class="flex-col w-full md:w-1/2 inline-block space-y-4">
                        <input type="hidden" name="action" value="update_sharing">

                        <div class="flex gap-x-8">
                            <div class="grow">
<label class="font-semibold text-foreground" for="max_days">时间范围</label>
                                <span class="block text-sm text-muted">（以天为单位；0 = 不公开，-1 = 无限制）</span>
                            </div>
                            <div>
                                <input class="input-default"
                                       style="max-width: 80px" type="number" id="max_days" name="max_days" min="-1" required
                                       value="{{ .User.ShareDataMaxDays }}">
                            </div>
                        </div>

                        <div class="flex gap-x-8">
                            <div class="grow">
                                <label class="font-semibold text-foreground" for="share_projects">分享项目</label>
                            </div>
                            <div>
<select autocomplete="off" id="share_projects" name="share_projects" class="select-default grow">
                                    <option value="false" class="cursor-pointer" {{ if not .User.ShareProjects }} selected {{ end }}>否
                                    </option>
                                    <option value="true" class="cursor-pointer" {{ if .User.ShareProjects }} selected {{ end }}>是
                                    </option>
                                </select>
                            </div>
                        </div>

                        <div class="flex gap-x-8">
                            <div class="grow">
                                <label class="font-semibold text-foreground" for="share_languages">分享语言</label>
                            </div>
                            <div>
<select autocomplete="off" id="share_languages" name="share_languages" class="select-default grow">
                                    <option value="false" class="cursor-pointer" {{ if not .User.ShareLanguages }} selected {{ end }}>否
                                    </option>
                                    <option value="true" class="cursor-pointer" {{ if .User.ShareLanguages }} selected {{ end }}>是
                                    </option>
                                </select>
                            </div>
                        </div>

                        <div class="flex gap-x-8">
                            <div class="grow">
                                <label class="font-semibold text-foreground" for="share_editors">分享编辑器</label>
                            </div>
                            <div>
<select autocomplete="off" id="share_editors" name="share_editors" class="select-default grow">
                                    <option value="false" class="cursor-pointer" {{ if not .User.ShareEditors }} selected {{ end }}>否
                                    </option>
                                    <option value="true" class="cursor-pointer" {{ if .User.ShareEditors }} selected {{ end }}>是
                                    </option>
                                </select>
                            </div>
                        </div>

                        <div class="flex gap-x-8">
                            <div class="grow">
                                <label class="font-semibold text-foreground" for="share_oss">分享操作系统</label>
                            </div>
                            <div>
<select autocomplete="off" id="share_oss" name="share_oss" class="select-default grow">
                                    <option value="false" class="cursor-pointer" {{ if not .User.ShareOSs }} selected {{ end }}>否
                                    </option>
                                    <option value="true" class="cursor-pointer" {{ if .User.ShareOSs }} selected {{ end }}>是
                                    </option>
                                </select>
                            </div>
                        </div>

                        <div class="flex gap-x-8">
                            <div class="grow">
                                <label class="font-semibold text-foreground" for="share_machines">分享设备</label>
                            </div>
                            <div>
<select autocomplete="off" id="share_machines" name="share_machines" class="select-default grow">
                                    <option value="false" class="cursor-pointer" {{ if not .User.ShareMachines }} selected {{ end }}>否
                                    </option>
                                    <option value="true" class="cursor-pointer" {{ if .User.ShareMachines }} selected {{ end }}>是
                                    </option>
                                </select>
                            </div>
                        </div>

                        <div class="flex gap-x-8">
                            <div class="grow">
                                <label class="font-semibold text-foreground" for="share_labels">分享项目标签</label>
                            </div>
                            <div>
<select autocomplete="off" id="share_labels" name="share_labels" class="select-default grow">
                                    <option value="false" class="cursor-pointer" {{ if not .User.ShareLabels }} selected {{ end }}>否
                                    </option>
                                    <option value="true" class="cursor-pointer" {{ if .User.ShareLabels }} selected {{ end }}>是
                                    </option>
                                </select>
                            </div>
                        </div>

                        <div class="flex gap-x-8">
                            <div class="grow">
                                <label class="font-semibold text-foreground" for="share_labels">分享活动图表</label>
                            </div>
                            <div>
<select autocomplete="off" id="share_activity_chart" name="share_activity_chart" class="select-default grow">
                                    <option value="false" class="cursor-pointer" {{ if not .User.ShareActivityChart }} selected {{ end }}>否
                                    </option>
                                    <option value="true" class="cursor-pointer" {{ if .User.ShareActivityChart }} selected {{ end }}>是
                                    </option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="flex justify-end mt-4">
<button type="submit" class="btn-primary">
                        保存
                    </button>
                </div>
            </form>
        </div>

        <div v-cloak id="integrations" class="tab flex flex-col space-y-4" v-show="isActive('integrations')">
            <form action="" method="post" class="w-full lg:w-3/4">
                <input type="hidden" name="action" value="toggle_wakatime">

                {{ $placeholderText := "WakaTime API key" }}
                {{ if .User.WakatimeApiKey }}
                {{ $placeholderText = "********" }}
                {{ end }}

                <div class="flex flex-wrap md:flex-nowrap mb-8 gap-x-4">
<div class="w-full md:w-1/2 mb-4 md:mb-0 inline-block">
                        <label class="font-semibold text-foreground text-lg" for="select-timezone">WakaTime</label>
                        <span class="block text-sm text-muted">
                            您可以将 Wakapi 与官方 WakaTime（或另一个 Wakapi 实例，可选择指定自定义 API URL）连接，使发送到 Wakapi 的所有心跳都会被转发。这样，您可以同时使用两个服务。要开始使用，请获取<a class="link" href="https://wakatime.com/developers#authentication" rel="noopener noreferrer" target="_blank">您的 API 密钥</a>并粘贴到此处。<br><br>
                            要转发数据到另一个 Wakapi 实例，请使用 <span class="text-xs font-mono">https://&lt;your-server&gt;/api/compat/wakatime/v1</span> 作为 URL。<br><br>
                            请注意：启用此功能后，本服务器的运营者理论上可以无限访问您存储在 WakaTime 中的数据。如果您担心隐私问题，请不要启用此集成，或等待 OAuth 2 认证（<a
                                class="link" target="_blank" href="https://github.com/muety/wakapi/issues/94" rel="noopener noreferrer">#94</a>）实现。
                        </span>
                    </div>
                    <div class="w-full md:w-1/2">
                        <input type="url" name="api_url" id="wakatime_api_url"
                               class="w-full appearance-none bg-card text-foreground outline-none rounded py-2 px-4 mb-2 {{ if not .User.WakatimeApiKey }}focus:bg-focused{{ end }} {{ if .User.WakatimeApiKey }}cursor-not-allowed{{ end }}"
                               placeholder="{{ defaultWakatimeUrl }}" {{ if .User.WakatimeApiKey }}readonly{{ end }} value="{{ .User.WakaTimeURL "" }}">
                        <input type="password" name="api_key" id="wakatime_api_key"
                               class="w-full appearance-none bg-card text-foreground outline-none rounded py-2 px-4 mt-2 {{ if not .User.WakatimeApiKey }}focus:bg-focused{{ end }} {{ if .User.WakatimeApiKey }}cursor-not-allowed{{ end }}"
                               placeholder="{{ $placeholderText }}" {{ if .User.WakatimeApiKey }}readonly{{ end }}>
<div class="mt-2 text-foreground">
                            <input type="checkbox" name="use_legacy_importer" id="use_legacy_importer_tmp" class="mr-1 cursor-pointer">
                            <label for="use_legacy_importer_tmp" class="mx-1">使用旧版导入器</label>
                            <span class="cursor-help" title="如果 WakaTime 导入反复失败，您可能需要回退到较旧、效率较低的导入机制">&#9432;</span>
                        </div>
                    </div>
                </div>

<div class="flex justify-end mt-4">
                    {{ if not .User.WakatimeApiKey }}
                    <button type="submit" class="btn-primary">连接</button>
                    {{ else }}
                    <button id="btn-import-wakatime" type="button" class="py-2 px-4 font-semibold rounded bg-card hover:bg-focused text-primary text-sm mr-1" @click.stop="confirmWakatimeImport">导入数据</button>
                    <button type="submit" class="btn-danger ml-1">断开连接</button>
                    {{ end }}
                </div>
            </form>

            <form action="" method="post" id="form-import-wakatime">
                <input type="hidden" name="action" value="import_wakatime">
                <input type="hidden" name="use_legacy_importer" id="use_legacy_importer">
            </form>

            <div class="w-full lg:w-3/4">
                <hr class="border-t border-focused mb-4">
            </div>

            <div class="w-full lg:w-3/4">
                <div class="flex flex-wrap md:flex-nowrap mb-8 gap-x-4">
                    <div class="w-full md:w-1/2 mb-4 md:mb-0 inline-block">
<label class="font-semibold text-foreground text-lg" for="select-timezone">徽章</label>
                        <span class="block text-sm text-muted">
                            此集成功能允许您生成用于 README 页面或论坛的徽章。要启用此功能，您需要授予对相应端点的公开未授权访问权限。请参阅<a class="link" href="settings#permissions">权限</a>。调整 URL 的 <i>label</i> 和 <i>color</i> 参数可自定义徽章。<br><br>
                            此外，还有一个与 <a class="link" href="https://shields.io" target="_blank" rel="noreferrer noopener">Shields.IO</a> 兼容的端点，允许更多自定义选项（如不同的<a class="link" href="https://shields.io/#styles" target="_blank" rel="noreferrer noopener">样式</a>）。仅在公共实例上可用，不适用于 localhost。
                        </span>
                    </div>

                    <div class="w-full md:w-1/2 ml-4">
                        {{ if ne .User.ShareDataMaxDays 0 }}
                        <div class="flex gap-x-4 mb-4">
                            <div class="flex items-center w-1/3">
                                <img class="with-url-src"
                                     src="api/badge/{{ .User.ID }}/interval:today?label=today"
                                     alt="Badge"/>
                            </div>
                            <input
                                    class="with-url-value w-2/3 font-mono text-xs appearance-none bg-card text-secondary outline-none rounded py-2 px-4 cursor-not-allowed"
                                    value="%s/api/badge/{{ .User.ID }}/interval:today?label=today"
                                    readonly>
                        </div>

                        <div class="flex gap-x-4 mt-4">
                            <div class="flex items-center w-1/3">
                                <img class="with-url-src"
                                     src="api/badge/{{ .User.ID }}/interval:30_days?label=last%2030d"
                                     alt="Badge"
                                />
                            </div>
                            <input
                                    class="with-url-value w-2/3 font-mono text-xs appearance-none bg-card text-secondary outline-none rounded py-2 px-4 cursor-not-allowed"
                                    value="%s/api/badge/{{ .User.ID }}/{{ .User.ID }}/interval:30_days?label=last%2030d"
                                    readonly>
                        </div>

                        <div class="flex gap-x-4 mt-4">
                            <div class="flex items-center w-1/3">
                                <img class="with-url-src"
                                     src="https://img.shields.io/endpoint?url=%s/api/compat/shields/v1/{{ .User.ID }}/interval:all_time&label=All%20time&color=blue"
                                     alt="Shields.io badge"/>
                            </div>
                            <input
                                    class="with-url-value w-2/3 font-mono text-xs appearance-none bg-card text-secondary outline-none rounded py-2 px-4 cursor-not-allowed"
                                    value="https://img.shields.io/endpoint?url=%s/api/compat/shields/v1/{{ .User.ID }}/interval:all_time&label=All%20time&color=blue"
                                    readonly>
                        </div>
                        {{ end }}
                    </div>
                </div>
            </div>

            <div class="w-full lg:w-3/4">
                <hr class="border-t border-focused mb-4">
            </div>

            <div class="w-full lg:w-3/4">
                <div class="flex flex-wrap md:flex-nowrap mb-8 gap-x-4">
                    <div class="w-full md:w-1/2 mb-4 md:mb-0 inline-block">
                        <label class="font-semibold text-foreground text-lg" for="select-timezone">GitHub Readme Stats</label>
<span class="block text-sm text-muted">
                            Wakapi 与 <a class="link" href="https://github.com/anuraghazra/github-readme-stats#wakatime-week-stats" target="_blank" rel="noreferrer noopener">GitHub Readme Stats</a> 集成，可为您生成精美的统计卡片。要启用此功能，您需要授予对相应端点的公开未授权访问权限。请参阅<a class="link" href="settings#permissions">权限</a>。<br><br>
                            分享 >= 7 天的数据 → 每周统计卡片<br>
                            分享 >= 366 天的数据 → 每年统计卡片<br>
                            分享所有数据 (-1) → 全部时间统计卡片<br><br>
                            仅在公共实例上可用，不适用于 localhost。
                        </span>
                    </div>

                    <div class="w-full md:w-1/2">
                        {{ if ne .User.ShareDataMaxDays 0 }}
                        <div class="flex items-center mb-2">
                            <img src="{{ if .User.ReadmeStatsBaseUrl }}{{ .User.ReadmeStatsBaseUrl }}{{ else }}https://github-readme-stats.vercel.app{{ end }}/api/wakatime?username={{ .User.ID }}&api_domain=%s&bg_color=1A202C&title_color=2F855A&icon_color=2F855A&text_color=ffffff&custom_title={{ .ReadmeCardCustomTitle }}&layout=compact"
                                 class="with-url-src-no-scheme" alt="Readme Stats Card">
                        </div>
                        <textarea
                                class="with-url-inner-no-scheme shrink w-full font-mono text-xs appearance-none bg-card text-secondary outline-none rounded py-2 px-4 cursor-not-allowed mt-2"
                                rows="5" style="resize: none"
                                readonly>{{ if .User.ReadmeStatsBaseUrl }}{{ .User.ReadmeStatsBaseUrl }}{{ else }}https://github-readme-stats.vercel.app{{ end }}/api/wakatime?username={{ .User.ID }}&api_domain=%s&bg_color=1A202C&title_color=2F855A&icon_color=2F855A&text_color=ffffff&custom_title={{ .ReadmeCardCustomTitle | urlquery }}&layout=compact</textarea>

                        <form class="w-full mt-4" action="" method="post">
                            <input type="hidden" name="action" value="update_readme_stats_base_url">
                            <div class="flex flex-col flex-grow gap-y-1">
                                <label class="font-semibold text-foreground text-sm" for="readme_stats_base_url">自定义 github-readme-stats 基础 URL</label>
                                <input class="input-default w-full text-sm" type="url" id="readme_stats_base_url" name="readme_stats_base_url" placeholder="https://github-readme-stats.vercel.app" value="{{ .User.ReadmeStatsBaseUrl }}">
                            </div>
                            <div class="flex justify-end mt-4">
                                <button type="submit" class="btn-primary h-min py-2">保存</button>
                            </div>
                        </form>
                        {{ end }}
                    </div>
                </div>
            </div>
        </div>

        {{ if .SubscriptionsEnabled }}
        <div v-cloak id="subscription" class="tab flex flex-col space-y-4" v-if="isActive('subscription')">
            <div class="w-full lg:w-1/2">
<span class="font-semibold text-foreground text-lg">订阅</span>
                <span class="block text-sm text-muted">
                        默认情况下，此 Wakapi 实例仅会存储 {{ .DataRetentionMonths }} 个月的历史编码活动数据。
                        但是，如果您想支持本项目，可以选择每月 {{ .SubscriptionPrice }} 的付费订阅，以获得无限制的历史记录。
                        您可以随时取消订阅！<br>
                        了解更多关于在 Wakapi 添加付费订阅的想法，请点击<a class="link" href="https://github.com/muety/wakapi/discussions/447" target="_blank" rel="noopener noreferrer">这里</a>。
                        如果您有任何与订阅相关的问题，请通过 <a class="link" href="mailto:{{ .SupportContact }}" target="_blank" rel="noopener noreferrer">{{ .SupportContact }}</a> 联系我们。<br>
                    </span>
                <br>

                {{ if not .User.HasActiveSubscription }}
<span class="font-semibold text-foreground">工作原理</span>
                <span class="block text-sm text-muted">
                    如果没有订阅，您超过 {{ .DataRetentionMonths }} 个月的编码活动数据将被每天运行的定时任务删除。
                    如果在检查时您有活跃的订阅，您的数据将被保留。<br>
                    换句话说，对于任何时间点 <span class="text-xs font-mono">X</span>，如果您当前没有活跃订阅，所有早于 <span class="text-xs font-mono">X - {{ .DataRetentionMonths }}</span> 个月的数据将被删除。
                </span>
                <br>
<span class="font-semibold text-foreground">请注意</span>
                <span class="block text-sm text-muted">如果您刚刚购买了订阅，可能需要一段时间才能激活。请稍后刷新此页面。如有问题，请联系我们！</span>
                <span class="block text-sm text-muted">购买订阅即表示您同意 Stripe 根据其<a href="https://stripe.com/privacy" class="link" target="_blank" rel="noopener noreferrer">隐私政策</a>处理您的邮箱地址以及所有可选提供的账单信息。</span>
                <br>

                {{ end }}

                {{ if not .UserFirstData.IsZero }}
<span class="block text-sm text-muted">
                    您目前最早的数据记录来自 <span class="text-foreground font-semibold">{{ .UserFirstData | datetime }}</span>。
                </span>
                <br>
                {{ end }}

<span class="font-semibold text-foreground">订阅状态：</span>
                <span class="text-muted ml-1 text-sm">
                    {{ if .User.HasActiveSubscription }}
                    <span class="font-semibold text-green-500 text-base">已激活</span>
                    {{ if .User.SubscriptionRenewal }}
                    （将于 {{ .User.SubscriptionRenewal.T | date }} 自动续订）
                    {{ else }}
                    （有效期至 {{ .User.SubscribedUntil.T | date }}）
                    {{ end }}
                    {{ else }}
                    <span class="font-semibold text-red-500 text-base">未激活</span>
                    {{ end }}
                </span>

                {{ if not .User.HasActiveSubscription }}
                <form action="subscription/checkout" method="post" class="mt-8 mb-8" id="form-subscription-checkout">
                    {{ if ne .User.Email "" }}
<button type="submit" class="btn-primary mt-4">订阅（{{ .SubscriptionPrice }} / 月）</button>
                    {{ else }}
                    <button type="submit" class="btn-disabled cursor-pointer mt-4" disabled title="">订阅（{{ .SubscriptionPrice }} / 月）</button>
                    <br>
                    <span class="text-xs text-muted">您需要提供邮箱地址才能购买订阅。</span>
                    {{ end }}
                </form>
                {{ else }}
                <form action="subscription/portal" method="post" class="mt-8 mb-8" id="form-subscription-portal">
                    <button type="submit" class="btn-primary">管理订阅</button>
                </form>
                {{ end }}
            </div>
        </div>
        {{ end }}

        <div v-cloak id="api_keys" class="tab flex flex-col space-y-4" v-if="isActive('api_keys')">
            <div class="w-full lg:w-3/4">
                <form action="" method="post" class="flex mb-8">
                    <input type="hidden" name="action" value="reset_apikey">

                    <div class="w-1/2 mr-4">
<span class="font-semibold text-foreground text-lg">重置主 API 密钥</span>
                        <span class="block text-sm text-muted">
                            请注意，重置 API 密钥后，您需要更新所有计算机上的 <code>.wakatime.cfg</code> 文件，以使 WakaTime 客户端重新发送心跳。
                        </span>
                    </div>
                    <div class="w-1/2 ml-4 flex items-center justify-end">
                        <button type="submit" class="btn-danger ml-1">重置 API 密钥</button>
                    </div>
                </form>
            </div>

            <div class="flex w-full lg:w-3/4 justify-between items-center" id="form-generate-api-key">
                <div class="w-1/2 mb-8">
<span class="font-semibold text-foreground text-lg">添加 API 密钥</span>
                    <span class="block text-sm text-muted">
                        除了始终存在的主（又称<i>默认</i>）API 密钥外，您还可以为不同的应用程序创建额外的 API 密钥来访问 Wakapi。您可以授予只读访问权限或读写访问权限，后者还允许发送心跳数据。
                    </span>
                </div>

                <form action="" method="post" class="flex justify-end shrink-0">
                    <input type="hidden" name="action" value="add_api_key">

                    <div class="flex gap-2 items-center justify-end">
                        <input class="appearance-none bg-card text-foreground outline-none rounded py-2 px-4 focus:bg-focused"
                               type="text" id="api-name" name="api_name" placeholder="密钥名称" minlength="1"
                               maxlength="64" required>
                        <select autocomplete="off" id="api-readonly" name="api_readonly" class="select-default grow">
<option value="false" class="cursor-pointer">读写</option>
                            <option value="true" class="cursor-pointer">只读</option>
                        </select>
                        <button type="submit" class="btn-primary">添加</button>
                    </div>
                </form>
            </div>

            <div class="w-full lg:w-3/4">
<span class="flex font-semibold text-foreground text-lg mb-2">API 密钥列表</span>

                <table class="w-full">
                    <thead>
                    <tr>
                        <th class="text-left py-2 text-muted w-1/4">名称</th>
                        <th class="text-left py-2 text-muted w-1/2">密钥</th>
                        <th class="text-center py-2 text-muted w-1/6">类型</th>
                        <th class="text-center py-2 text-muted w-1/6">操作</th>
                    </tr>
                    </thead>
                    <tbody>
                    {{ range $i, $ApiKey := .ApiKeys }}
                    <tr>
                        <td class="py-2 text-foreground">{{ $ApiKey.Name }}</td>
                        <td class="py-2 text-muted font-mono text-sm">{{ $ApiKey.Value }}</td>
                        <td class="py-2 text-center">
                            {{ if $ApiKey.ReadOnly }}
<span class=" rounded-full text-xs">
                                        只读
                                    </span>
                            {{ else }}
                            <span class="rounded-full text-xs text-accent">
                                        完全访问
                                    </span>
                            {{ end }}
                        </td>
                        <td class="py-2 text-center">
                            <form action="" method="post" class="inline">
                                <input type="hidden" name="action" value="delete_api_key">
                                <input type="hidden" name="api_key_value" value="{{ $ApiKey.Value }}">
                                <button type="submit" class="py-2 px-4 rounded bg-card hover:bg-focused text-danger text-sm" title="删除 API 密钥">✕</button>
                            </form>
                        </td>
                    </tr>
                    {{ end }}
                    </tbody>
                </table>
            </div>
        </div>

        <div v-cloak id="danger_zone" class="tab flex flex-col space-y-4" v-if="isActive('danger_zone')">
            <div class="w-full lg:w-3/4">
                <form action="" method="post" class="flex mb-8" id="form-regenerate-summaries">
                    <input type="hidden" name="action" value="regenerate_summaries">

                    <div class="w-1/2 mr-4 inline-block">
<span class="font-semibold text-foreground">重新生成摘要</span>
                        <span class="block text-sm text-muted">
                            从原始心跳数据重新生成所有预计算的摘要。如果由于某些原因摘要出现问题或前提条件发生变化（例如您回溯修改了语言映射），这可能会很有用。这可能需要一些时间。请谨慎操作，只有在您知道自己在做什么的情况下才执行此操作，因为可能会发生数据丢失。
                        </span>
                    </div>
                    <div class="w-1/2 ml-4 flex items-center">
                        <button type="button" class="btn-danger ml-1" @click.stop="confirmRegenerate">清除并重新生成</button>
                    </div>
                </form>

                <form action="" method="post" class="flex mb-8" id="form-clear-data">
                    <input type="hidden" name="action" value="clear_data">

                    <div class="w-1/2 mr-4 inline-block">
<span class="font-semibold text-foreground">清除数据</span>
                        <span class="block text-sm text-muted">
                            清除 Wakapi 中您的所有时间追踪数据。此操作无法撤销。请谨慎操作！
                        </span>
                    </div>
                    <div class="w-1/2 ml-4 flex items-center">
                        <button type="button" class="btn-danger ml-1" @click.stop="confirmClearData">清除数据</button>
                    </div>
                </form>

                <form action="" method="post" class="flex mb-8" id="form-change-username">
                    <input type="hidden" name="action" value="change_userid">

                    <div class="w-1/2 mr-4 inline-block">
<span class="font-semibold text-foreground">更改用户名</span>
                        <span class="block text-sm text-muted">
                            您可以更改用户名，但不建议这样做。之后，您只能使用新用户名登录。此外，所有外部引用的 URL 等都必须更新。这可能需要几分钟时间。
                        </span>
                    </div>
                    <div class="w-1/2 ml-4 gap-x-2 flex items-center">
                        <input class="input-default {{ if .User.HasActiveSubscription }}cursor-not-allowed{{ end }}"
                               type="text" id="new_userid"
name="new_userid" placeholder="输入新用户名..." style="width: auto;">
                        <button type="button" class="btn-danger ml-1" @click.stop="confirmChangeUsername">应用</button>
                    </div>
                </form>

                <form action="" method="post" class="flex mb-8" id="form-delete-user">
                    <input type="hidden" name="action" value="delete_account">

                    <div class="w-1/2 mr-4 inline-block">
<span class="font-semibold text-foreground">删除账户</span>
                        <span class="block text-sm text-muted">
                            删除您的账户将导致所有数据（包括所有心跳数据）立即从服务器中删除。此操作不可逆。请谨慎操作！
                        </span>
                    </div>
                    <div class="w-1/2 ml-4 flex items-center">
                        <button type="button" class="btn-danger ml-1" @click.stop="confirmDeleteAccount">删除账户</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</main>

{{ template "footer.tpl.html" . }}

{{ template "foot.tpl.html" . }}
</body>

</html>
